(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{456:function(t,a,e){"use strict";e.r(a);var s=e(15),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"webpack-概念"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webpack-概念"}},[t._v("#")]),t._v(" Webpack 概念")]),t._v(" "),e("p",[e("em",[t._v("webpack")]),t._v("  是一个现代的 JavaScript 应用程序的"),e("em",[t._v("模块打包器(module bundler)")]),t._v("。当 webpack 处理应用程序时，它会递归地构建一个"),e("em",[t._v("依赖关系图表(dependency graph)")]),t._v("，其中包含应用程序需要的每个模块，然后将所有这些模块打包成少量的  "),e("em",[t._v("bundle")]),t._v(" - 通常只有一个，由浏览器加载。")]),t._v(" "),e("p",[t._v("学习 webpack，需要先了解几个核心概念，下面会一一道来。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/frontend-tutorial/master/docs/assets/images/webpack-introduction.png",alt:"webpack-introduction"}})]),t._v(" "),e("h2",{attrs:{id:"模块化-module"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#模块化-module"}},[t._v("#")]),t._v(" 模块化(module)")]),t._v(" "),e("p",[t._v("在"),e("a",{attrs:{href:"https://en.wikipedia.org/wiki/Modular_programming",target:"_blank",rel:"noopener noreferrer"}},[t._v("模块化编程"),e("OutboundLink")],1),t._v("中，开发者将程序分解相对独立的代码块，并称之为"),e("em",[t._v("模块")]),t._v("。")]),t._v(" "),e("p",[t._v("每个模块具有比完整程序更小的接触面，使得校验、调试、测试轻而易举。 精心编写的"),e("em",[t._v("模块")]),t._v("提供了可靠的抽象和封装界限，使得应用程序中每个模块都具有条理清楚的设计和明确的目的。")]),t._v(" "),e("p",[t._v("Node.js 从最一开始就支持模块化编程。然而，在 web，"),e("em",[t._v("模块化")]),t._v("的支持正缓慢到来。在 web 存在多种支持 JavaScript 模块化的工具，这些工具各有优势和限制。webpack 基于从这些系统获得的经验教训，并将"),e("em",[t._v("模块")]),t._v("的概念应用于项目中的任何文件。")]),t._v(" "),e("h3",{attrs:{id:"什么是-webpack-模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是-webpack-模块"}},[t._v("#")]),t._v(" 什么是 webpack 模块")]),t._v(" "),e("p",[t._v("对比  "),e("a",{attrs:{href:"https://nodejs.org/api/modules.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node.js 模块"),e("OutboundLink")],1),t._v("，webpack "),e("em",[t._v("模块")]),t._v("能够以各种方式表达它们的依赖关系，几个例子如下：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import",target:"_blank",rel:"noopener noreferrer"}},[t._v("ES2015 "),e("code",[t._v("import")]),e("OutboundLink")],1),t._v("  语句")]),t._v(" "),e("li",[e("a",{attrs:{href:"http://www.commonjs.org/specs/modules/1.0/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CommonJS"),e("OutboundLink")],1),t._v(" "),e("code",[t._v("require()")]),t._v("  语句")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/amdjs/amdjs-api/blob/master/AMD.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("AMD"),e("OutboundLink")],1),t._v(" "),e("code",[t._v("define")]),t._v("  和  "),e("code",[t._v("require")]),t._v("  语句")]),t._v(" "),e("li",[t._v("css/sass/less 文件中的  "),e("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/@import",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("@import")]),t._v("  语句"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("li",[t._v("样式("),e("code",[t._v("url(...)")]),t._v(")或 HTML 文件(``)中的图片链接(image url)")])]),t._v(" "),e("blockquote",[e("p",[t._v("webpack 1 需要特定的 loader 来转换 ES 2015 "),e("code",[t._v("import")]),t._v("，然而 webpack 2 天然支持。")])]),t._v(" "),e("h3",{attrs:{id:"支持的模块类型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#支持的模块类型"}},[t._v("#")]),t._v(" 支持的模块类型")]),t._v(" "),e("p",[t._v("webpack 通过  "),e("em",[t._v("loader")]),t._v("  可以支持各种语言和预处理器编写模块。"),e("em",[t._v("loader")]),t._v("  描述了 webpack "),e("strong",[t._v("如何")]),t._v("处理 非 JavaScript(non-JavaScript) "),e("em",[t._v("模块")]),t._v("，并且在"),e("em",[t._v("bundle")]),t._v("中引入这些"),e("em",[t._v("依赖")]),t._v("。 webpack 社区已经为各种流行语言和语言处理器构建了  "),e("em",[t._v("loader")]),t._v("，包括：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"http://coffeescript.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CoffeeScript"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.typescriptlang.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("TypeScript"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://babeljs.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ESNext (Babel)"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"http://sass-lang.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sass"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"http://lesscss.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Less"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"http://stylus-lang.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Stylus"),e("OutboundLink")],1)])]),t._v(" "),e("p",[t._v("总的来说，webpack 提供了可定制的、强大和丰富的 API，允许"),e("strong",[t._v("任何技术栈")]),t._v("使用 webpack，保持了在你的开发、测试和生成流程中"),e("strong",[t._v("无侵入性(non-opinionated)")]),t._v("。")]),t._v(" "),e("h2",{attrs:{id:"配置文件-webpack-config-js"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置文件-webpack-config-js"}},[t._v("#")]),t._v(" 配置文件 - webpack.config.js")]),t._v(" "),e("blockquote",[e("p",[t._v("webpack 是高度可配置的，如何模块化打包、加载都可以基于配置文件定制。")]),t._v(" "),e("p",[t._v("webpack 的默认配置文件是 "),e("code",[t._v("webpack.config.js")]),t._v("。")])]),t._v(" "),e("p",[t._v("因为 webpack 配置是标准的 Node.js CommonJS 模块，你可以使用"),e("strong",[t._v("如下特性")]),t._v("：")]),t._v(" "),e("ul",[e("li",[t._v("通过  "),e("code",[t._v("require(...)")]),t._v("  导入其他文件")]),t._v(" "),e("li",[t._v("通过  "),e("code",[t._v("require(...)")]),t._v("  使用 npm 的工具函数")]),t._v(" "),e("li",[t._v("使用 JavaScript 控制流表达式，例如  "),e("code",[t._v("?:")]),t._v("  操作符")]),t._v(" "),e("li",[t._v("对常用值使用常量或变量")]),t._v(" "),e("li",[t._v("编写并执行函数来生成部分配置")])]),t._v(" "),e("h2",{attrs:{id:"依赖图表-dependency-graph"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#依赖图表-dependency-graph"}},[t._v("#")]),t._v(" 依赖图表(Dependency Graph)")]),t._v(" "),e("p",[t._v("任何时候，一个文件依赖于另一个文件，webpack 就把此视为文件之间有"),e("em",[t._v("依赖关系")]),t._v("。这使得 webpack 可以接收非代码资源(non-code asset)（例如图像或 web 字体），并且可以把它们作为"),e("em",[t._v("依赖")]),t._v("提供给你的应用程序。")]),t._v(" "),e("p",[t._v("webpack 从命令行或配置文件中定义的一个模块列表开始，处理你的应用程序。 从这些"),e("em",[t._v("入口起点")]),t._v("开始，webpack 递归地构建一个"),e("em",[t._v("依赖图表")]),t._v("，这个依赖图表包含着应用程序所需的每个模块，然后将所有这些模块打包为少量的  "),e("em",[t._v("bundle")]),t._v("- 通常只有一个 - 可由浏览器加载。")]),t._v(" "),e("blockquote",[e("p",[t._v("对于  "),e("em",[t._v("HTTP/1.1")]),t._v("  客户端，由 webpack 打包你的应用程序会尤其强大，因为在浏览器发起一个新请求时，它能够减少应用程序必须等待的时间。对于  "),e("em",[t._v("HTTP/2")]),t._v("，你还可以使用代码拆分(Code Splitting)以及通过 webpack 打包来实现"),e("a",{attrs:{href:"https://medium.com/webpack/webpack-http-2-7083ec3f3ce6#.7y5d3hz59",target:"_blank",rel:"noopener noreferrer"}},[t._v("最佳优化"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),e("h2",{attrs:{id:"入口-entry"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#入口-entry"}},[t._v("#")]),t._v(" 入口(entry)")]),t._v(" "),e("p",[t._v("webpack 将创建所有应用程序的"),e("strong",[t._v("依赖关系图表(dependency graph)")]),t._v("。图表的起点被称之为"),e("em",[t._v("入口起点(entry point)")]),t._v("。"),e("em",[t._v("入口起点")]),t._v("告诉 webpack "),e("em",[t._v("从哪里开始")]),t._v("，并遵循着依赖关系图表知道"),e("em",[t._v("要打包什么")]),t._v("。可以将您应用程序的"),e("em",[t._v("入口起点")]),t._v("认为是**根上下文(contextual root)**或  "),e("strong",[t._v("app 第一个启动文件")]),t._v("。")]),t._v(" "),e("p",[t._v("在 webpack 中，我们使用  "),e("a",{attrs:{href:"https://doc.webpack-china.org/configuration",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack 配置对象(webpack configuration object)"),e("OutboundLink")],1),t._v("  中的  "),e("code",[t._v("entry")]),t._v("  属性来定义"),e("em",[t._v("入口")]),t._v("。")]),t._v(" "),e("p",[t._v("例：")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./path/to/my/entry/file.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"输出-output"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#输出-output"}},[t._v("#")]),t._v(" 输出(output)")]),t._v(" "),e("p",[t._v("将所有的资源(assets)归拢在一起后，还需要告诉 webpack "),e("strong",[t._v("在哪里")]),t._v("打包应用程序。webpack 的  "),e("code",[t._v("output")]),t._v("  属性描述了"),e("strong",[t._v("如何处理归拢在一起的代码")]),t._v("(bundled code)。")]),t._v(" "),e("p",[t._v("例：")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./path/to/my/entry/file.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  output"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dist"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    filename"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-first-webpack.bundle.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"加载-loader"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#加载-loader"}},[t._v("#")]),t._v(" 加载(loader)")]),t._v(" "),e("p",[t._v("webpack 的目标是，让  "),e("strong",[t._v("webpack")]),t._v("  聚焦于项目中的所有资源(asset)，而浏览器不需要关注考虑这些（这并不意味着资源(asset)都必须打包在一起）。webpack 把"),e("a",{attrs:{href:"https://doc.webpack-china.org/concepts/modules",target:"_blank",rel:"noopener noreferrer"}},[t._v("每个文件(.css, .html, .scss, .jpg, etc.) 都作为模块"),e("OutboundLink")],1),t._v("处理。然而 webpack "),e("strong",[t._v("只理解 JavaScript")]),t._v("。")]),t._v(" "),e("p",[e("strong",[t._v("webpack loader 会将这些文件转换为模块，而转换后的文件会被添加到依赖图表中。")])]),t._v(" "),e("p",[t._v("在更高层面，webpack 的配置有两个目标。")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("识别出(identify)应该被对应的 loader 进行转换(transform)的那些文件")])]),t._v(" "),e("li",[e("p",[t._v("由于进行过文件转换，所以能够将被转换的文件添加到依赖图表（并且最终添加到 bundle 中）("),e("code",[t._v("use")]),t._v("  属性)")])])]),t._v(" "),e("p",[t._v("例：")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" config "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./path/to/my/entry/file.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  output"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dist"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    filename"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-first-webpack.bundle.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  module"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    rules"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" test"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token regex"}},[e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.(js|jsx)$")]),e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" use"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"babel-loader"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"插件-plugins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#插件-plugins"}},[t._v("#")]),t._v(" 插件(plugins)")]),t._v(" "),e("p",[t._v("由于 loader 仅在每个文件的基础上执行转换，而  "),e("code",[t._v("插件(plugins)")]),t._v("  最常用于（但不限于）在打包模块的“compilation”和“chunk”生命周期执行操作和自定义功能"),e("a",{attrs:{href:"https://doc.webpack-china.org/concepts/plugins",target:"_blank",rel:"noopener noreferrer"}},[t._v("（查看更多）"),e("OutboundLink")],1),t._v("。webpack 的插件系统"),e("a",{attrs:{href:"https://doc.webpack-china.org/api/plugins",target:"_blank",rel:"noopener noreferrer"}},[t._v("极其强大和可定制化"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("p",[t._v("想要使用一个插件，你只需要  "),e("code",[t._v("require()")]),t._v("  它，然后把它添加到  "),e("code",[t._v("plugins")]),t._v("  数组中。多数插件可以通过选项(option)自定义。你也可以在一个配置文件中因为不同目的而多次使用同一个插件，你需要使用  "),e("code",[t._v("new")]),t._v("  创建实例来调用它。")]),t._v(" "),e("p",[t._v("例：")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" HtmlWebpackPlugin "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"html-webpack-plugin"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//installed via npm")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" webpack "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webpack"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//to access built-in plugins")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"path"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" config "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./path/to/my/entry/file.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  output"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dist"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    filename"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-first-webpack.bundle.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  module"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    rules"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" test"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token regex"}},[e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.(js|jsx)$")]),e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" use"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"babel-loader"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  plugins"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("webpack"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("optimize"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UglifyJsPlugin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HtmlWebpackPlugin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" template"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/index.html"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"热替换-hot-module-replacement"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#热替换-hot-module-replacement"}},[t._v("#")]),t._v(" 热替换(Hot Module Replacement)")]),t._v(" "),e("p",[t._v("模块热替换功能会在应用程序运行过程中替换、添加或删除"),e("a",{attrs:{href:"https://doc.webpack-china.org/concepts/modules/",target:"_blank",rel:"noopener noreferrer"}},[t._v("模块"),e("OutboundLink")],1),t._v("，而无需重新加载页面。这使得你可以在独立模块变更后，无需刷新整个页面，就可以更新这些模块，极大地加速了开发时间。")]),t._v(" "),e("h3",{attrs:{id:"这一切是如何运行的"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#这一切是如何运行的"}},[t._v("#")]),t._v(" 这一切是如何运行的？")]),t._v(" "),e("h3",{attrs:{id:"站在-app-的角度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#站在-app-的角度"}},[t._v("#")]),t._v(" 站在 App 的角度")]),t._v(" "),e("ol",[e("li",[t._v("app 代码要求 HMR runtime 检查更新。")]),t._v(" "),e("li",[t._v("HMR runtime （异步）下载更新，然后通知 app 代码更新可用。")]),t._v(" "),e("li",[t._v("app 代码要求 HMR runtime 应用更新。")]),t._v(" "),e("li",[t._v("HMR runtime （异步）应用更新。")])]),t._v(" "),e("p",[t._v("你可以设置 HMR，使此进程自动触发更新，或者你可以选择要求在用户交互后进行更新。")]),t._v(" "),e("h4",{attrs:{id:"站在编译器-webpack-的角度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#站在编译器-webpack-的角度"}},[t._v("#")]),t._v(" 站在编译器(webpack) 的角度")]),t._v(" "),e("p",[t._v('除了普通资源，编译器(compiler)需要发出 "update"，以允许更新之前的版本到新的版本。"update" 由两部分组成：')]),t._v(" "),e("ol",[e("li",[t._v("待更新 manifest (JSON)")]),t._v(" "),e("li",[t._v("一个或多个待更新 chunk (JavaScript)")])]),t._v(" "),e("p",[t._v("manifest 包括新的编译 hash 和所有的待更新 chunk 目录。")]),t._v(" "),e("p",[t._v("每个待更新 chunk 包括用于与所有被更新模块相对应 chunk 的代码（或一个 flag 用于表明模块要被移除）。")]),t._v(" "),e("p",[t._v("编译器确保模块 ID 和 chunk ID 在这些构建之间保持一致。通常将这些 ID 存储在内存中（例如，当使用  "),e("a",{attrs:{href:"https://doc.webpack-china.org/configuration/dev-server/",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-dev-server"),e("OutboundLink")],1),t._v("  时），但是也可能将它们存储在一个 JSON 文件中。")]),t._v(" "),e("h4",{attrs:{id:"站在模块的角度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#站在模块的角度"}},[t._v("#")]),t._v(" 站在模块的角度")]),t._v(" "),e("p",[t._v("HMR 是可选功能，只会影响包含 HMR 代码的模块。举个例子，通过  "),e("a",{attrs:{href:"https://github.com/webpack/style-loader",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("style-loader")]),e("OutboundLink")],1),t._v("  为 style 样式追加补丁。 为了运行追加补丁，"),e("code",[t._v("style-loader")]),t._v("  实现了 HMR 接口；当它通过 HMR 接收到更新，它会使用新的样式替换旧的样式。")]),t._v(" "),e("p",[t._v("类似的，当在一个模块中实现了 HMR 接口，你可以描述出当模块被更新后发生了什么。然而在多数情况下，不需要强制在每个模块中写入 HMR 代码。如果一个模块没有 HMR 处理函数，更新就会冒泡。这意味着一个简单的处理函数能够对整个模块树(complete module tree)进行处理。如果在这个模块树中，一个单独的模块被更新，那么整个模块树都会被重新加载（只会重新加载，不会迁移）。")]),t._v(" "),e("h4",{attrs:{id:"站在-hmr-runtime-的角度-technical"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#站在-hmr-runtime-的角度-technical"}},[t._v("#")]),t._v(" 站在 HMR Runtime 的角度 (Technical)")]),t._v(" "),e("p",[t._v("对于模块系统的 runtime，附加的代码被发送到  "),e("code",[t._v("parents")]),t._v("  和  "),e("code",[t._v("children")]),t._v("  跟踪模块。")]),t._v(" "),e("p",[t._v("在管理方面，runtime 支持两个方法  "),e("code",[t._v("check")]),t._v("  和  "),e("code",[t._v("apply")]),t._v("。")]),t._v(" "),e("p",[e("code",[t._v("check")]),t._v("  发送 HTTP 请求来更新 manifest。如果请求失败，说明没有可用更新。如果请求成功，待更新 chunk 会和当前加载过的 chunk 进行比较。对每个加载过的 chunk，会下载相对应的待更新 chunk。当所有待更新 chunk 完成下载，就会准备切换到  "),e("code",[t._v("ready")]),t._v("  状态。")]),t._v(" "),e("p",[e("code",[t._v("apply")]),t._v("  方法将所有被更新模块标记为无效。对于每个无效模块，都需要在模块中有一个更新处理函数，或者在它的父级模块们中有更新处理函数。否则，无效标记冒泡，并将父级也标记为无效。每个冒泡继续直到到达应用程序入口起点，或者到达带有更新处理函数的模块（以最先到达为准）。如果它从入口起点开始冒泡，则此过程失败。")]),t._v(" "),e("p",[t._v('之后，所有无效模块都被（通过 dispose 处理函数）处理和解除加载。然后更新当前 hash，并且调用所有 "accept" 处理函数。runtime 切换回'),e("code",[t._v("闲置")]),t._v("状态，一切照常继续。")]),t._v(" "),e("h3",{attrs:{id:"产生的文件-technical"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#产生的文件-technical"}},[t._v("#")]),t._v(" 产生的文件 (Technical)")]),t._v(" "),e("p",[t._v("左侧表示初始编译器通过。右侧表示更新了模块 4 和 9 。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://camo.githubusercontent.com/afdb8057414988ac33b85eb25a225181f9efb7b1/687474703a2f2f7765627061636b2e6769746875622e696f2f6173736574732f484d522e737667",alt:"generated update chunks"}})]),t._v(" "),e("h3",{attrs:{id:"它能够用于"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#它能够用于"}},[t._v("#")]),t._v(" 它能够用于？")]),t._v(" "),e("p",[t._v("你可以在开发过程中将 HMR 作为 LiveReload 的替代。"),e("a",{attrs:{href:"https://doc.webpack-china.org/configuration/dev-server/",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-dev-server"),e("OutboundLink")],1),t._v("  支持热模式，在试图重新加载整个页面之前，热模式会尝试使用 HMR 来更新。查看如何实现"),e("a",{attrs:{href:"https://doc.webpack-china.org/guides/hmr-react",target:"_blank",rel:"noopener noreferrer"}},[t._v("在 React 项目中使用 HMR"),e("OutboundLink")],1),t._v("  为例。")]),t._v(" "),e("p",[t._v("一些 loader 已经生成可热更新的模块。例如，"),e("code",[t._v("style-loader")]),t._v("  能够置换出页面的样式表。对于这样的模块，你不需要做任何特殊处理。")]),t._v(" "),e("p",[t._v("webpack 的强大之处在于它的可定制化，取决于特定项目需求，这里有"),e("em",[t._v("许多")]),t._v("配置 HMR 的方式。")]),t._v(" "),e("h1",{attrs:{id:"webpack-系列教程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webpack-系列教程"}},[t._v("#")]),t._v(" Webpack 系列教程")]),t._v(" "),e("p",[t._v("欢迎阅读其它内容：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/dunwu/frontend-tutorial/tree/master/docs/chapter03/webpack/concept.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Webpack 概念"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/dunwu/frontend-tutorial/tree/master/docs/chapter03/webpack/webpack-tutorial.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Webpack 入门"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/dunwu/frontend-tutorial/tree/master/docs/chapter03/webpack/asset-management.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Webpack 资源管理"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/dunwu/frontend-tutorial/tree/master/docs/chapter03/webpack/code-splitting.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Webpack 代码分离"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/dunwu/frontend-tutorial/tree/master/docs/chapter03/webpack/development.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Webpack 开发工具"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);